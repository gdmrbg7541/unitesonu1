<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ŸÇŸêŸäŸéŸÖŸä - ÿ™ŸÖÿ±ŸäŸÜ ÿ™ÿ±ÿ™Ÿäÿ® ÿßŸÑÿ¨ŸÖŸÑ</title>
    <link href="https://fonts.googleapis.com/css2?family=Markazi+Text:wght@400;700&family=Noto+Naskh+Arabic:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- Temel Sayfa Stilleri --- */
        :root {
            --accent-color: #007bff;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --bg-light: #f8f9fa;
            --font-arabic: 'Markazi Text', 'Noto Naskh Arabic', 'Tahoma', 'Arial', sans-serif;
        }

        body {
            font-family: var(--font-arabic);
            background-color: #e9ecef;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            font-weight: 400;
        }

        /* --- Ana Etkinlik Alanƒ± --- */
        .activity-container {
            position: relative;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            width: 90vw;
            height: calc(90vw * 9 / 16); /* 16:9 */
            max-height: 90vh;
            max-width: calc(90vh * 16 / 9); /* 16:9 */
        }
        
        /* --- Header ve D√ºƒümeler --- */
        .back-button-container {
            grid-area: back;
            display: flex;
            justify-content: flex-end; 
            align-items: center; 
        }
        .back-button, #fullscreen-btn {
            background: #f0f0f0;
            color: #555;
            border: 1px solid #ccc;
            border-radius: 1.5vmin;
            cursor: pointer;
            width: clamp(40px, 8vmin, 55px);
            height: clamp(40px, 8vmin, 55px);
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0; 
        }
        .back-button {
            text-decoration: none;
        }
        #fullscreen-btn {
             margin-left: 10px; 
        }
        .back-button:hover, #fullscreen-btn:hover {
            background: #e0e0e0;
        }
        .back-button svg, #fullscreen-btn svg {
            width: clamp(24px, 5vmin, 30px);
            height: clamp(24px, 5vmin, 30px);
            fill: currentColor;
        }
        
        #fullscreen-btn .icon-open { display: block; }
        #fullscreen-btn .icon-close { display: none; }
        body.fullscreen #fullscreen-btn .icon-open { display: none; }
        body.fullscreen #fullscreen-btn .icon-close { display: block; }

        body.fullscreen .activity-container {
            width: 100vw;
            height: calc(100vw * 9 / 16); 
            max-height: 100vh;
            max-width: calc(100vh * 16 / 9);
            border-radius: 0;
            box-shadow: none;
        }


        /* --- Ba≈ülƒ±k ve ƒ∞lerleme --- */
        .header {
            padding: 15px 25px;
            border-bottom: 1px solid #dee2e6;
            display: grid;
            grid-template-areas: "progress instruction back"; 
            grid-template-columns: 200px 1fr 200px;
            align-items: center;
            gap: 20px;
        }
        
        #instruction-text { 
            grid-area: instruction;
            text-align: center; 
            font-size: 2.2rem; 
            font-weight: 700;
            color: #555;
            font-family: var(--font-arabic);
        }
        
        .progress-container { 
            grid-area: progress;
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: flex-start;
            width: 200px;
            direction: ltr; 
        }
        #progress-display {
            font-size: 1.5rem; 
            font-weight: bold;
            color: var(--accent-color);
            flex-shrink: 0;
        }
        .progress-bar-container {
            flex-grow: 1;
            height: 12px;
            background-color: #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }
        #progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--accent-color);
            transition: width 0.4s ease, background-color 0.4s ease;
        }


        /* --- Etkinlik Alanƒ± --- */
        .activity-area {
            flex-grow: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow-y: auto;
        }

        /* --- C√ºmle Sƒ±ralama --- */
        .scramble-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        .drop-zone, .drag-zone {
            border: 2px dashed #d0d0d0;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            min-height: 120px;
            background: var(--bg-light);
            display: flex;
            flex-wrap: wrap;
            align-content: center; 
            flex-grow: 1; 
            transition: all 0.3s ease;
        }
        .drop-zone {
            border-style: solid;
            border-color: var(--accent-color);
            font-size: 2.5rem; 
            justify-content: center;
        }
        .drag-zone {
             justify-content: center;
        }
        
        /* --- Kutu Efektleri --- */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-8px); }
            40%, 80% { transform: translateX(8px); }
        }
        .drop-zone-correct {
            border-color: var(--success-color);
            background-color: #f0f9f2; 
        }
        .drop-zone-incorrect {
            border-color: var(--danger-color);
            background-color: #fcf2f2; 
            animation: shake 0.4s ease-in-out;
        }
        
        .word-item {
            padding: 12px 20px;
            color: white;
            font-size: 2.8rem; 
            font-weight: 700;
            margin: 8px;
            border-radius: 8px;
            cursor: grab; 
            user-select: none;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .word-item[draggable="true"] {
            cursor: grab;
        }
        .word-item[draggable="true"]:active {
            cursor: grabbing;
        }
        .word-item[draggable="false"] {
            cursor: default;
        }
        
        
        .word-item:hover { filter: brightness(85%); }
        .word-item.dragging { opacity: 0.5; cursor: grabbing; }
        .word-item.dragging { 
            opacity: 0.8; /* Hafif ≈üeffaflƒ±k iyidir */
            transform: scale(1.05); /* Biraz b√ºy√ºt */
            box-shadow: 0 10px 20px rgba(0,0,0,0.2); /* Y√ºkselme efekti */
            /* Not: JS artƒ±k 'position: fixed' ekliyor, bu y√ºzden 'opacity: 0.5' 
               olan eski kuralƒ± g√ºncelleyebilirsiniz. */
        }
        
        /* --- Kontrol Butonlarƒ± --- */
        #check-scramble-btn, #reset-scramble-btn, #next-activity-btn {
            padding: 15px 30px;
            font-size: 2rem; 
            font-family: var(--font-arabic);
            font-weight: 700;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            margin: 5px;
            display: flex; 
            align-items: center;
            justify-content: center;
        }
        #check-scramble-btn {
            background-color: var(--success-color);
            color: white;
        }
        #reset-scramble-btn {
            background-color: var(--danger-color);
            color: white;
        }
        #next-activity-btn {
            background-color: var(--accent-color);
            color: white;
            padding: 0; 
            width: clamp(55px, 10vmin, 70px); 
            height: clamp(55px, 10vmin, 70px);
            border-radius: 50%; 
        }
        #next-activity-btn svg {
            width: clamp(30px, 6vmin, 40px);
            height: clamp(30px, 6vmin, 40px);
            fill: currentColor;
        }

        .scramble-controls {
            display: flex;
            justify-content: center;
            margin-top: 15px;
            flex-shrink: 0;
            transition: all 0.3s ease; 
        }
        
        /* --- Biti≈ü Ekranƒ± --- */
        #finish-screen {
            text-align: center;
            font-weight: 700;
            color: var(--accent-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            font-family: var(--font-arabic);
        }
        #finish-screen p { font-size: 3.5rem; margin: 10px 0; }
        .score-display {
            display: flex;
            gap: 30px;
            font-size: 2.8rem; 
            margin: 20px 0;
            direction: ltr;
        }
        .score-item { font-weight: 700; }
        .score-correct { color: var(--success-color); }
        .score-incorrect { color: var(--danger-color); }

        #replay-button {
            font-size: 4.5rem; 
            background: none;
            border: none;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            transition: transform 0.2s ease, background-color 0.2s ease;
            font-family: var(--font-arabic);
        }
        #replay-button:hover { transform: rotate(-90deg); background-color: #f0f0f0; }
        
        /* --- Mobil D√ºzen --- */
        @media (orientation: portrait) {
            .activity-container {
                width: 95vw;
                height: calc(95vw * 16 / 9); /* 9:16 */
                max-height: 95vh;
                max-width: calc(95vh * 9 / 16); /* 9:16 */
            }

            .header {
                grid-template-areas: 
                    "progress back"
                    "instruction instruction";
                grid-template-columns: 1fr 1fr; 
                gap: 10px;
                padding: 10px 15px;
            }

            .progress-container { width: auto; justify-content: flex-start; }
            .back-button-container { justify-content: flex-end; }
            #instruction-text { font-size: 1.4rem; min-width: unset; justify-self: center; }
            #progress-display { font-size: 1.2rem; }

            .scramble-container .word-item { font-size: 1.8rem; padding: 8px 15px; margin: 5px; }
            .scramble-container .drop-zone { font-size: 1.8rem; min-height: 80px;  }
            .scramble-container .drag-zone { min-height: 100px; }
            .scramble-container .scramble-controls { margin-top: 5px; }
            .scramble-container #check-scramble-btn,
            .scramble-container #reset-scramble-btn,
            .scramble-container #next-activity-btn { 
                font-size: 1.5rem; 
                padding: 10px 20px; 
            }
            .scramble-container #next-activity-btn {
                padding: 0;
                width: 55px;
                height: 55px;
            }
            
            body.fullscreen .activity-container {
                width: 100vw;
                height: calc(100vw * 16 / 9);
                max-height: 100vh;
                max-width: calc(100vh * 9 / 16);
            }
        }

    </style>
</head>
<body>

    <div class="activity-container">
        
        <div class="header">
            <div class="progress-container">
                <div id="progress-display">...</div> 
                <div class="progress-bar-container">
                    <div id="progress-bar"></div>
                </div>
            </div>
            
            <div id="instruction-text">...</div>

            <div class="back-button-container">
                <button id="fullscreen-btn">
                    <svg class="icon-open" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M5 10h2V7h3V5H5v5zM14 5v2h3v3h2V5h-5zM5 19v-5h2v3h3v2H5zM14 19v-2h3v-3h2v5h-5z"/>
                    </svg>
                    <svg class="icon-close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>
                    </svg>
                </button>
                
                <a href="index.html" class="back-button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                </a>
            </div>
        </div>

        <div class="activity-area" id="activity-area">
            </div>

    </div>

    <script>
        // --- ETKƒ∞NLƒ∞K VERƒ∞LERƒ∞ (√áoklu Varyasyonlar Eklendi) ---
        const activitiesData = [
            { s: ["ŸäŸéÿ¨Ÿêÿ®Ÿè ÿπŸéŸÑŸâ ÿßŸÑŸÖŸèÿ≥ŸíŸÑŸêŸÖ ÿ£ŸéŸÜŸí ŸäŸéŸÉŸàŸÜŸé ÿµÿßÿØŸêŸÇŸãÿß", "ÿπŸéŸÑŸâ ÿßŸÑŸÖŸèÿ≥ŸíŸÑŸêŸÖ ŸäŸéÿ¨Ÿêÿ®Ÿè ÿ£ŸéŸÜŸí ŸäŸéŸÉŸàŸÜŸé ÿµÿßÿØŸêŸÇŸãÿß", "ÿ£ŸéŸÜŸí ŸäŸéŸÉŸàŸÜŸé ÿµÿßÿØŸêŸÇŸãÿß ŸäŸéÿ¨Ÿêÿ®Ÿè ÿπŸéŸÑŸâ ÿßŸÑŸÖŸèÿ≥ŸíŸÑŸêŸÖ"], w: ["ŸäŸéÿ¨Ÿêÿ®Ÿè", "ÿπŸéŸÑŸâ", "ÿßŸÑŸÖŸèÿ≥ŸíŸÑŸêŸÖ", "ÿ£ŸéŸÜŸí", "ŸäŸéŸÉŸàŸÜŸé", "ÿµÿßÿØŸêŸÇŸãÿß"] },
            { s: ["ÿßŸÑÿ£ŸéŸÖÿßŸÜŸéÿ© ŸÖŸêŸÜŸí ÿµŸêŸÅÿßÿ™ ÿßŸÑŸÖŸèÿ§ŸíŸÖŸêŸÜ", "ŸÖŸêŸÜŸí ÿµŸêŸÅÿßÿ™ ÿßŸÑŸÖŸèÿ§ŸíŸÖŸêŸÜ ÿßŸÑÿ£ŸéŸÖÿßŸÜŸéÿ©"], w: ["ÿßŸÑÿ£ŸéŸÖÿßŸÜŸéÿ©", "ŸÖŸêŸÜŸí", "ÿµŸêŸÅÿßÿ™", "ÿßŸÑŸÖŸèÿ§ŸíŸÖŸêŸÜ"] },
            { s: ["ÿßŸÑÿ•ŸêÿÆŸíŸÑÿßÿµ ŸÅŸä ÿßŸÑÿπŸéŸÖŸéŸÑ ŸäŸèÿ§ŸéÿØŸëŸä ÿ•ŸêŸÑŸâ ÿßŸÑŸÜŸéŸëÿ¨ÿßÿ≠", "ŸäŸèÿ§ŸéÿØŸëi ÿßŸÑÿ•ŸêÿÆŸíŸÑÿßÿµ ŸÅŸä ÿßŸÑÿπŸéŸÖŸéŸÑ ÿ•ŸêŸÑŸâ ÿßŸÑŸÜŸéŸëÿ¨ÿßÿ≠", "ŸÅŸä ÿßŸÑÿπŸéŸÖŸéŸÑ ÿßŸÑÿ•ŸêÿÆŸíŸÑÿßÿµ ŸäŸèÿ§ŸéÿØŸëŸä ÿ•ŸêŸÑŸâ ÿßŸÑŸÜŸéŸëÿ¨ÿßÿ≠"], w: ["ÿßŸÑÿ•ŸêÿÆŸíŸÑÿßÿµ", "ŸÅŸä", "ÿßŸÑÿπŸéŸÖŸéŸÑ", "ŸäŸèÿ§ŸéÿØŸëŸä", "ÿ•ŸêŸÑŸâ", "ÿßŸÑŸÜŸéŸëÿ¨ÿßÿ≠"] },
            { s: ["ÿßŸÑÿ™ŸéŸëÿπÿßŸàŸèŸÜ ŸäŸèŸÇŸéŸàŸëŸä ÿßŸÑŸÖŸèÿ¨Ÿíÿ™ŸéŸÖŸéÿπ", "ŸäŸèŸÇŸéŸàŸëŸä ÿßŸÑÿ™ŸéŸëÿπÿßŸàŸèŸÜ ÿßŸÑŸÖŸèÿ¨Ÿíÿ™ŸéŸÖŸéÿπ"], w: ["ÿßŸÑÿ™ŸéŸëÿπÿßŸàŸèŸÜ", "ŸäŸèŸÇŸéŸàŸëŸä", "ÿßŸÑŸÖŸèÿ¨Ÿíÿ™ŸéŸÖŸéÿπ"] },
            { s: ["ŸÜŸèÿ≠Ÿêÿ®ŸèŸë ÿ£ŸéÿµŸíÿØŸêŸÇÿßÿ°ŸéŸÜÿß ŸàŸéŸÜŸéÿ≠Ÿíÿ™Ÿéÿ±ŸêŸÖŸèŸáŸèŸÖ"], w: ["ŸÜŸèÿ≠Ÿêÿ®ŸèŸë", "ÿ£ŸéÿµŸíÿØŸêŸÇÿßÿ°ŸéŸÜÿß", "ŸàŸéŸÜŸéÿ≠Ÿíÿ™Ÿéÿ±ŸêŸÖŸèŸáŸèŸÖ"] },
            { s: ["ŸäŸéÿ¨Ÿêÿ®Ÿè ÿπŸéŸÑŸéŸäŸíŸÜÿß ÿ£ŸéŸÜŸí ŸÜŸèÿ≥ÿßÿπŸêÿØŸé ÿßŸÑŸÉŸêÿ®ÿßÿ± ŸàŸéŸÜŸéÿ±Ÿíÿ≠ŸéŸÖŸé ÿßŸÑÿµŸêŸëÿ∫ÿßÿ±", "ÿπŸéŸÑŸéŸäŸíŸÜÿß ŸäŸéÿ¨Ÿêÿ®Ÿè ÿ£ŸéŸÜŸí ŸÜŸèÿ≥ÿßÿπŸêÿØŸé ÿßŸÑŸÉŸêÿ®ÿßÿ± ŸàŸéŸÜŸéÿ±Ÿíÿ≠ŸéŸÖŸé ÿßŸÑÿµŸêŸëÿ∫ÿßÿ±", "ÿ£ŸéŸÜŸí ŸÜŸèÿ≥ÿßÿπŸêÿØŸé ÿßŸÑŸÉŸêÿ®ÿßÿ± ŸàŸéŸÜŸéÿ±Ÿíÿ≠ŸéŸÖŸé ÿßŸÑÿµŸêŸëÿ∫ÿßÿ± ŸäŸéÿ¨Ÿêÿ®Ÿè ÿπŸéŸÑŸéŸäŸíŸÜÿß"], w: ["ŸäŸéÿ¨Ÿêÿ®Ÿè", "ÿπŸéŸÑŸéŸäŸíŸÜÿß", "ÿ£ŸéŸÜŸí", "ŸÜŸèÿ≥ÿßÿπŸêÿØŸé", "ÿßŸÑŸÉŸêÿ®ÿßÿ±", "ŸàŸéŸÜŸéÿ±Ÿíÿ≠ŸéŸÖŸé", "ÿßŸÑÿµŸêŸëÿ∫ÿßÿ±"] },
            { s: ["ŸÖŸéŸÜŸí ŸäŸéÿ¥ŸíŸÉŸèÿ±Ÿè ÿßŸÑŸÑŸá ŸäŸéÿ≤ŸíÿØŸéÿØŸí ÿÆŸéŸäŸíÿ±Ÿãÿß"], w: ["ŸÖŸéŸÜŸí", "ŸäŸéÿ¥ŸíŸÉŸèÿ±Ÿè", "ÿßŸÑŸÑŸá", "ŸäŸéÿ≤ŸíÿØŸéÿØŸí", "ÿÆŸéŸäŸíÿ±Ÿãÿß"] },
            { s: ["ÿ£ŸéÿπŸíÿ™Ÿéÿ∞Ÿêÿ±Ÿè ÿπŸêŸÜŸíÿØ ÿßŸÑÿÆŸéÿ∑Ÿéÿ•", "ÿπŸêŸÜŸíÿØ ÿßŸÑÿÆŸéÿ∑Ÿéÿ• ÿ£ŸéÿπŸíÿ™Ÿéÿ∞Ÿêÿ±Ÿè"], w: ["ÿ£ŸéÿπŸíÿ™Ÿéÿ∞Ÿêÿ±Ÿè", "ÿπŸêŸÜŸíÿØ", "ÿßŸÑÿÆŸéÿ∑Ÿéÿ•"] },
            { s: ["ÿßŸÑŸÖŸèÿ≥ŸíŸÑŸêŸÖ ŸÑÿß ŸäŸéŸÉŸíÿ∞Ÿêÿ®Ÿè ŸàŸéŸÑÿß ŸäŸèÿ§Ÿíÿ∞Ÿä ÿ£Ÿéÿ≠ŸéÿØŸãÿß", "ŸÑÿß ŸäŸéŸÉŸíÿ∞Ÿêÿ®Ÿè ÿßŸÑŸÖŸèÿ≥ŸíŸÑŸêŸÖ ŸàŸéŸÑÿß ŸäŸèÿ§Ÿíÿ∞Ÿä ÿ£Ÿéÿ≠ŸéÿØŸãÿß"], w: ["ÿßŸÑŸÖŸèÿ≥ŸíŸÑŸêŸÖ", "ŸÑÿß", "ŸäŸéŸÉŸíÿ∞Ÿêÿ®Ÿè", "ŸàŸéŸÑÿß", "ŸäŸèÿ§Ÿíÿ∞Ÿä", "ÿ£Ÿéÿ≠ŸéÿØŸãÿß"] },
            { s: ["ŸäŸéÿ™ŸéŸÉŸéŸÑŸéŸëŸÖŸè ÿßŸÑÿ∑ŸëÿßŸÑŸêÿ® ÿ®Ÿêÿ£ŸéÿØŸéÿ® ŸÖŸéÿπ ÿßŸÑŸÖŸèÿØŸéÿ±ŸêŸëÿ≥", "ÿßŸÑÿ∑ŸëÿßŸÑŸêÿ® ŸäŸéÿ™ŸéŸÉŸéŸÑŸéŸëŸÖŸè ÿ®Ÿêÿ£ŸéÿØŸéÿ® ŸÖŸéÿπ ÿßŸÑŸÖŸèÿØŸéÿ±ŸêŸëÿ≥", "ÿ®Ÿêÿ£ŸéÿØŸéÿ® ŸäŸéÿ™ŸéŸÉŸéŸÑŸéŸëŸÖŸè ÿßŸÑÿ∑ŸëÿßŸÑŸêÿ® ŸÖŸéÿπ ÿßŸÑŸÖŸèÿØŸéÿ±ŸêŸëÿ≥", "ŸÖŸéÿπ ÿßŸÑŸÖŸèÿØŸéÿ±ŸêŸëÿ≥ ŸäŸéÿ™ŸéŸÉŸéŸÑŸéŸëŸÖŸè ÿßŸÑÿ∑ŸëÿßŸÑŸêÿ® ÿ®Ÿêÿ£ŸéÿØŸéÿ®"], w: ["ŸäŸéÿ™ŸéŸÉŸéŸÑŸéŸëŸÖŸè", "ÿßŸÑÿ∑ŸëÿßŸÑŸêÿ®", "ÿ®Ÿêÿ£ŸéÿØŸéÿ®", "ŸÖŸéÿπ", "ÿßŸÑŸÖŸèÿØŸéÿ±ŸêŸëÿ≥"] },
            { s: ["ŸäŸèÿ≥ŸéŸÑŸêŸëŸÖŸè ÿßŸÑÿ∑ŸëÿßŸÑŸêÿ® ÿπŸéŸÑŸâ ÿ£ŸéÿµŸíÿØŸêŸÇÿßÿ¶ŸêŸáŸê ŸÅŸä ÿßŸÑÿµŸéŸëÿ®ÿßÿ≠", "ÿßŸÑÿ∑ŸëÿßŸÑŸêÿ® ŸäŸèÿ≥ŸéŸÑŸêŸëŸÖŸè ÿπŸéŸÑŸâ ÿ£ŸéÿµŸíÿØŸêŸÇÿßÿ¶ŸêŸáŸê ŸÅŸä ÿßŸÑÿµŸéŸëÿ®ÿßÿ≠", "ŸÅŸä ÿßŸÑÿµŸéŸëÿ®ÿßÿ≠ ŸäŸèÿ≥ŸéŸÑŸêŸëŸÖŸè ÿßŸÑÿ∑ŸëÿßŸÑŸêÿ® ÿπŸéŸÑŸâ ÿ£ŸéÿµŸíÿØŸêŸÇÿßÿ¶ŸêŸáŸê", "ÿπŸéŸÑŸâ ÿ£ŸéÿµŸíÿØŸêŸÇÿßÿ¶ŸêŸáŸê ŸäŸèÿ≥ŸéŸÑŸêŸëŸÖŸè ÿßŸÑÿ∑ŸëÿßŸÑŸêÿ® ŸÅŸä ÿßŸÑÿµŸéŸëÿ®ÿßÿ≠"], w: ["ŸäŸèÿ≥ŸéŸÑŸêŸëŸÖŸè", "ÿßŸÑÿ∑ŸëÿßŸÑŸêÿ®", "ÿπŸéŸÑŸâ", "ÿ£ŸéÿµŸíÿØŸêŸÇÿßÿ¶ŸêŸáŸê", "ŸÅŸä", "ÿßŸÑÿµŸéŸëÿ®ÿßÿ≠"] },
            { s: ["ŸäŸéÿ®Ÿíÿ™Ÿéÿ≥ŸêŸÖŸè ÿØÿßÿ¶ŸêŸÖŸãÿß ŸàŸéŸäŸéÿ≠Ÿíÿ™Ÿéÿ±ŸêŸÖŸè ÿßŸÑÿ¢ÿÆŸéÿ±ŸäŸÜ", "ÿØÿßÿ¶ŸêŸÖŸãÿß ŸäŸéÿ®Ÿíÿ™Ÿéÿ≥ŸêŸÖŸè ŸàŸéŸäŸéÿ≠Ÿíÿ™Ÿéÿ±ŸêŸÖŸè ÿßŸÑÿ¢ÿÆŸéÿ±ŸäŸÜ"], w: ["ŸäŸéÿ®Ÿíÿ™Ÿéÿ≥ŸêŸÖŸè", "ÿØÿßÿ¶ŸêŸÖŸãÿß", "ŸàŸéŸäŸéÿ≠Ÿíÿ™Ÿéÿ±ŸêŸÖŸè", "ÿßŸÑÿ¢ÿÆŸéÿ±ŸäŸÜ"] },
            { s: ["ŸÑÿß ŸäŸéÿ∫Ÿíÿ∂Ÿéÿ®Ÿè ÿßŸÑŸÖŸèÿ§ŸíŸÖŸêŸÜ ÿπŸêŸÜŸíÿØŸé ÿßŸÑŸÖŸèÿ¥ŸíŸÉŸêŸÑŸéÿ©", "ÿßŸÑŸÖŸèÿ§ŸíŸÖŸêŸÜ ŸÑÿß ŸäŸéÿ∫Ÿíÿ∂Ÿéÿ®Ÿè ÿπŸêŸÜŸíÿØŸé ÿßŸÑŸÖŸèÿ¥ŸíŸÉŸêŸÑŸéÿ©", "ÿπŸêŸÜŸíÿØŸé ÿßŸÑŸÖŸèÿ¥ŸíŸÉŸêŸÑŸéÿ© ŸÑÿß ŸäŸéÿ∫Ÿíÿ∂Ÿéÿ®Ÿè ÿßŸÑŸÖŸèÿ§ŸíŸÖŸêŸÜ"], w: ["ŸÑÿß", "ŸäŸéÿ∫Ÿíÿ∂Ÿéÿ®Ÿè", "ÿßŸÑŸÖŸèÿ§ŸíŸÖŸêŸÜ", "ÿπŸêŸÜŸíÿØŸé", "ÿßŸÑŸÖŸèÿ¥ŸíŸÉŸêŸÑŸéÿ©"] },
            { s: ["ÿßŸÑÿµŸéŸëÿ®Ÿíÿ±Ÿè ŸÖŸêŸÅŸíÿ™Ÿéÿßÿ≠Ÿè ÿßŸÑŸíŸÅŸéÿ±Ÿéÿ¨Ÿê", "ŸÖŸêŸÅŸíÿ™Ÿéÿßÿ≠Ÿè ÿßŸÑŸíŸÅŸéÿ±Ÿéÿ¨Ÿê ÿßŸÑÿµŸéŸëÿ®Ÿíÿ±Ÿè"], w: ["ÿßŸÑÿµŸéŸëÿ®Ÿíÿ±Ÿè", "ŸÖŸêŸÅŸíÿ™Ÿéÿßÿ≠Ÿè", "ÿßŸÑŸíŸÅŸéÿ±Ÿéÿ¨Ÿê"] },
            { s: ["ÿßŸÑÿπŸéÿØŸíŸÑ ÿ£Ÿéÿ≥ÿßÿ≥ ÿßŸÑŸÖŸèÿ¨Ÿíÿ™ŸéŸÖŸéÿπ", "ÿ£Ÿéÿ≥ÿßÿ≥ ÿßŸÑŸÖŸèÿ¨Ÿíÿ™ŸéŸÖŸéÿπ ÿßŸÑÿπŸéÿØŸíŸÑ"], w: ["ÿßŸÑÿπŸéÿØŸíŸÑ", "ÿ£Ÿéÿ≥ÿßÿ≥", "ÿßŸÑŸÖŸèÿ¨Ÿíÿ™ŸéŸÖŸéÿπ"] },
            { s: ["ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ±Ÿéÿ© ÿßŸÑÿ≥ŸéŸëÿπŸäÿØŸéÿ© ÿ™ŸéÿπŸäÿ¥Ÿè ŸÅŸä ÿ≠Ÿèÿ®Ÿë ŸàŸéÿßÿ≠Ÿíÿ™Ÿêÿ±ŸéÿßŸÖ", "ÿ™ŸéÿπŸäÿ¥Ÿè ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ±Ÿéÿ© ÿßŸÑÿ≥ŸéŸëÿπŸäÿØŸéÿ© ŸÅŸä ÿ≠Ÿèÿ®Ÿë ŸàŸéÿßÿ≠Ÿíÿ™Ÿêÿ±ŸéÿßŸÖ", "ŸÅŸä ÿ≠Ÿèÿ®Ÿë ŸàŸéÿßÿ≠Ÿíÿ™Ÿêÿ±ŸéÿßŸÖ ÿ™ŸéÿπŸäÿ¥Ÿè ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ±Ÿéÿ© ÿßŸÑÿ≥ŸéŸëÿπŸäÿØŸéÿ©"], w: ["ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ±Ÿéÿ©", "ÿßŸÑÿ≥ŸéŸëÿπŸäÿØŸéÿ©", "ÿ™ŸéÿπŸäÿ¥Ÿè", "ŸÅŸä", "ÿ≠Ÿèÿ®Ÿë", "ŸàŸéÿßÿ≠Ÿíÿ™Ÿêÿ±ŸéÿßŸÖ"] },
            { s: ["ŸäŸèÿ≥ÿßÿπŸêÿØŸè ÿßŸÑŸàŸéŸÑŸéÿØŸè ÿ£Ÿéÿ®ÿßŸáŸè ŸÅŸä ÿßŸÑÿ®ŸéŸäŸíÿ™", "ŸäŸèÿ≥ÿßÿπŸêÿØŸè ÿßŸÑŸàŸéŸÑŸéÿØŸè ŸÅŸä ÿßŸÑÿ®ŸéŸäŸíÿ™ ÿ£Ÿéÿ®ÿßŸáŸè", "ÿßŸÑŸàŸéŸÑŸéÿØŸè ŸäŸèÿ≥ÿßÿπŸêÿØŸè ÿ£Ÿéÿ®ÿßŸáŸè ŸÅŸä ÿßŸÑÿ®ŸéŸäŸíÿ™", "ŸÅŸä ÿßŸÑÿ®ŸéŸäŸíÿ™ ŸäŸèÿ≥ÿßÿπŸêÿØŸè ÿßŸÑŸàŸéŸÑŸéÿØŸè ÿ£Ÿéÿ®ÿßŸáŸè"], w: ["ŸäŸèÿ≥ÿßÿπŸêÿØŸè", "ÿßŸÑŸàŸéŸÑŸéÿØŸè", "ÿ£Ÿéÿ®ÿßŸáŸè", "ŸÅŸä", "ÿßŸÑÿ®ŸéŸäŸíÿ™"] },
            { s: ["ÿ™ŸèÿπŸäŸÜŸè ÿßŸÑÿ®ŸêŸÜŸíÿ™ ÿ£ŸèŸÖŸéŸëŸáÿß ŸÅŸä ÿßŸÑŸÖŸéÿ∑Ÿíÿ®ŸéÿÆ", "ÿ™ŸèÿπŸäŸÜŸè ÿßŸÑÿ®ŸêŸÜŸíÿ™ ŸÅŸä ÿßŸÑŸÖŸéÿ∑Ÿíÿ®ŸéÿÆ ÿ£ŸèŸÖŸéŸëŸáÿß", "ÿßŸÑÿ®ŸêŸÜŸíÿ™ ÿ™ŸèÿπŸäŸÜŸè ÿ£ŸèŸÖŸéŸëŸáÿß ŸÅŸä ÿßŸÑŸÖŸéÿ∑Ÿíÿ®ŸéÿÆ", "ŸÅŸä ÿßŸÑŸÖŸéÿ∑Ÿíÿ®ŸéÿÆ ÿ™ŸèÿπŸäŸÜŸè ÿßŸÑÿ®ŸêŸÜŸíÿ™ ÿ£ŸèŸÖŸéŸëŸáÿß"], w: ["ÿ™ŸèÿπŸäŸÜŸè", "ÿßŸÑÿ®ŸêŸÜŸíÿ™", "ÿ£ŸèŸÖŸéŸëŸáÿß", "ŸÅŸä", "ÿßŸÑŸÖŸéÿ∑Ÿíÿ®ŸéÿÆ"] },
            { s: ["ŸäŸèŸÇŸéÿ®ŸêŸëŸÑŸè ÿßŸÑÿ£Ÿéÿ®ŸíŸÜÿßÿ° ŸäŸéÿØŸé ÿßŸÑŸàÿßŸÑŸêÿØŸéŸäŸíŸÜ ŸÉŸèŸÑŸë ÿµŸéÿ®ÿßÿ≠", "ÿßŸÑÿ£Ÿéÿ®ŸíŸÜÿßÿ° ŸäŸèŸÇŸéÿ®ŸêŸëŸÑŸè ŸäŸéÿØŸé ÿßŸÑŸàÿßŸÑŸêÿØŸéŸäŸíŸÜ ŸÉŸèŸÑŸë ÿµŸéÿ®ÿßÿ≠", "ŸÉŸèŸÑŸë ÿµŸéÿ®ÿßÿ≠ ŸäŸèŸÇŸéÿ®ŸêŸëŸÑŸè ÿßŸÑÿ£Ÿéÿ®ŸíŸÜÿßÿ° ŸäŸéÿØŸé ÿßŸÑŸàÿßŸÑŸêÿØŸéŸäŸíŸÜ"], w: ["ŸäŸèŸÇŸéÿ®ŸêŸëŸÑŸè", "ÿßŸÑÿ£Ÿéÿ®ŸíŸÜÿßÿ°", "ŸäŸéÿØŸé", "ÿßŸÑŸàÿßŸÑŸêÿØŸéŸäŸíŸÜ", "ŸÉŸèŸÑŸë", "ÿµŸéÿ®ÿßÿ≠"] },
            { s: ["ŸÜŸéÿ≤Ÿàÿ±Ÿè ÿßŸÑÿ£ŸéŸÇÿßÿ±Ÿêÿ® ŸÅŸä ŸÜŸêŸáÿßŸäŸéÿ© ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ®Ÿàÿπ", "ŸÅŸä ŸÜŸêŸáÿßŸäŸéÿ© ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ®Ÿàÿπ ŸÜŸéÿ≤Ÿàÿ±Ÿè ÿßŸÑÿ£ŸéŸÇÿßÿ±Ÿêÿ®"], w: ["ŸÜŸéÿ≤Ÿàÿ±Ÿè", "ÿßŸÑÿ£ŸéŸÇÿßÿ±Ÿêÿ®", "ŸÅŸä", "ŸÜŸêŸáÿßŸäŸéÿ©", "ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ®Ÿàÿπ"] },
            { s: ["ŸäŸéÿ¨Ÿíÿ™ŸéŸÖŸêÿπŸè ÿ£ŸéŸÅŸíÿ±ÿßÿØ ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ±Ÿéÿ© ÿπŸéŸÑŸâ ŸÖÿßÿ¶ŸêÿØŸéÿ© ÿßŸÑÿ∑ŸéŸëÿπÿßŸÖ", "ÿ£ŸéŸÅŸíÿ±ÿßÿØ ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ±Ÿéÿ© ŸäŸéÿ¨Ÿíÿ™ŸéŸÖŸêÿπŸè ÿπŸéŸÑŸâ ŸÖÿßÿ¶ŸêÿØŸéÿ© ÿßŸÑÿ∑ŸéŸëÿπÿßŸÖ", "ÿπŸéŸÑŸâ ŸÖÿßÿ¶ŸêÿØŸéÿ© ÿßŸÑÿ∑ŸéŸëÿπÿßŸÖ ŸäŸéÿ¨Ÿíÿ™ŸéŸÖŸêÿπŸè ÿ£ŸéŸÅŸíÿ±ÿßÿØ ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ±Ÿéÿ©"], w: ["ŸäŸéÿ¨Ÿíÿ™ŸéŸÖŸêÿπŸè", "ÿ£ŸéŸÅŸíÿ±ÿßÿØ", "ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ±Ÿéÿ©", "ÿπŸéŸÑŸâ", "ŸÖÿßÿ¶ŸêÿØŸéÿ©", "ÿßŸÑÿ∑ŸéŸëÿπÿßŸÖ"] },
            { s: ["ŸäŸéÿ™Ÿéÿ≠ŸéÿØŸéŸëÿ´ŸàŸÜŸé ÿ®Ÿêÿ≠Ÿèÿ®Ÿë ŸàŸéŸäŸéÿ∂Ÿíÿ≠ŸéŸÉŸàŸÜŸé ŸÖŸéÿπŸãÿß", "ÿ®Ÿêÿ≠Ÿèÿ®Ÿë ŸäŸéÿ™Ÿéÿ≠ŸéÿØŸéŸëÿ´ŸàŸÜŸé ŸàŸéŸäŸéÿ∂Ÿíÿ≠ŸéŸÉŸàŸÜŸé ŸÖŸéÿπŸãÿß"], w: ["ŸäŸéÿ™Ÿéÿ≠ŸéÿØŸéŸëÿ´ŸàŸÜŸé", "ÿ®Ÿêÿ≠Ÿèÿ®Ÿë", "ŸàŸéŸäŸéÿ∂Ÿíÿ≠ŸéŸÉŸàŸÜŸé", "ŸÖŸéÿπŸãÿß"] },
            { s: ["ŸäŸéÿ≠Ÿíÿ™Ÿéÿ±ŸêŸÖŸè ÿßŸÑÿ£Ÿéÿ®ŸíŸÜÿßÿ° ÿßŸÑŸÉŸêÿ®ÿßÿ± ŸàŸéŸäŸéÿ±Ÿíÿ≠ŸéŸÖŸàŸÜŸé ÿßŸÑÿµŸêŸëÿ∫ÿßÿ±", "ÿßŸÑÿ£Ÿéÿ®ŸíŸÜÿßÿ° ŸäŸéÿ≠Ÿíÿ™Ÿéÿ±ŸêŸÖŸè ÿßŸÑŸÉŸêÿ®ÿßÿ± ŸàŸéŸäŸéÿ±Ÿíÿ≠ŸéŸÖŸàŸÜŸé ÿßŸÑÿµŸêŸëÿ∫ÿßÿ±"], w: ["ŸäŸéÿ≠Ÿíÿ™Ÿéÿ±ŸêŸÖŸè", "ÿßŸÑÿ£Ÿéÿ®ŸíŸÜÿßÿ°", "ÿßŸÑŸÉŸêÿ®ÿßÿ±", "ŸàŸéŸäŸéÿ±Ÿíÿ≠ŸéŸÖŸàŸÜŸé", "ÿßŸÑÿµŸêŸëÿ∫ÿßÿ±"] },
            { s: ["ÿßŸÑÿ®ŸéŸäŸíÿ™ ÿßŸÑŸéŸëÿ∞Ÿä ŸÅŸäŸáŸê ŸÖŸéÿ≠Ÿéÿ®ŸéŸëÿ© ŸáŸèŸàŸé ÿßŸÑÿ®ŸéŸäŸíÿ™ ÿßŸÑÿ≥ŸéŸëÿπŸäÿØ"], w: ["ÿßŸÑÿ®ŸéŸäŸíÿ™", "ÿßŸÑŸéŸëÿ∞Ÿä", "ŸÅŸäŸáŸê", "ŸÖŸéÿ≠Ÿéÿ®ŸéŸëÿ©", "ŸáŸèŸàŸé", "ÿßŸÑÿ®ŸéŸäŸíÿ™", "ÿßŸÑÿ≥ŸéŸëÿπŸäÿØ"] },
            { s: ["ÿßŸÑŸàÿßŸÑŸêÿØÿßŸÜ ŸäŸéÿ≥ŸíÿπŸéÿØÿßŸÜ ÿ®Ÿêÿ£Ÿéÿ®ŸíŸÜÿßÿ¶ŸêŸáŸêŸÖÿß ÿßŸÑŸÖŸèÿ§ŸéÿØŸéŸëÿ®ŸäŸÜ", "ŸäŸéÿ≥ŸíÿπŸéÿØÿßŸÜ ÿßŸÑŸàÿßŸÑŸêÿØÿßŸÜ ÿ®Ÿêÿ£Ÿéÿ®ŸíŸÜÿßÿ¶ŸêŸáŸêŸÖÿß ÿßŸÑŸÖŸèÿ§ŸéÿØŸéŸëÿ®ŸäŸÜ"], w: ["ÿßŸÑŸàÿßŸÑŸêÿØÿßŸÜ", "ŸäŸéÿ≥ŸíÿπŸéÿØÿßŸÜ", "ÿ®Ÿêÿ£Ÿéÿ®ŸíŸÜÿßÿ¶ŸêŸáŸêŸÖÿß", "ÿßŸÑŸÖŸèÿ§ŸéÿØŸéŸëÿ®ŸäŸÜ"] },
            { s: ["ŸÜŸèÿ≥ÿßÿπŸêÿØŸè ŸÅŸä ÿ™ŸéŸÜŸíÿ∏ŸäŸÅ ÿßŸÑÿ®ŸéŸäŸíÿ™ ŸÉŸèŸÑŸë ŸäŸéŸàŸíŸÖ", "ŸÅŸä ÿ™ŸéŸÜŸíÿ∏ŸäŸÅ ÿßŸÑÿ®ŸéŸäŸíÿ™ ŸÜŸèÿ≥ÿßÿπŸêÿØŸè ŸÉŸèŸÑŸë ŸäŸéŸàŸíŸÖ", "ŸÉŸèŸÑŸë ŸäŸéŸàŸíŸÖ ŸÜŸèÿ≥ÿßÿπŸêÿØŸè ŸÅŸä ÿ™ŸéŸÜŸíÿ∏ŸäŸÅ ÿßŸÑÿ®ŸéŸäŸíÿ™"], w: ["ŸÜŸèÿ≥ÿßÿπŸêÿØŸè", "ŸÅŸä", "ÿ™ŸéŸÜŸíÿ∏ŸäŸÅ", "ÿßŸÑÿ®ŸéŸäŸíÿ™", "ŸÉŸèŸÑŸë", "ŸäŸéŸàŸíŸÖ"] },
            { s: ["ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ±Ÿéÿ© ÿßŸÑŸÖŸèÿ™Ÿéÿ≠ÿßÿ®ŸéŸëÿ© ÿ™ŸÉŸàŸÜ ŸÇŸéŸàŸêŸäŸéŸëÿ© ŸàŸÖŸèÿ™ŸéŸÅÿßŸáŸêŸÖŸéÿ©", "ÿ™ŸÉŸàŸÜ ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ±Ÿéÿ© ÿßŸÑŸÖŸèÿ™Ÿéÿ≠ÿßÿ®ŸéŸëÿ© ŸÇŸéŸàŸêŸäŸéŸëÿ© ŸàŸÖŸèÿ™ŸéŸÅÿßŸáŸêŸÖŸéÿ©"], w: ["ÿßŸÑÿ£Ÿèÿ≥Ÿíÿ±Ÿéÿ©", "ÿßŸÑŸÖŸèÿ™Ÿéÿ≠ÿßÿ®ŸéŸëÿ©", "ÿ™ŸÉŸàŸÜ", "ŸÇŸéŸàŸêŸäŸéŸëÿ©", "ŸàŸÖŸèÿ™ŸéŸÅÿßŸáŸêŸÖŸéÿ©"] }
        ];

        // --- Gerekli Elementler ---
        const activityArea = document.getElementById('activity-area');
        const instructionText = document.getElementById('instruction-text');
        const progressDisplay = document.getElementById('progress-display');
        const progressBar = document.getElementById('progress-bar');

        // --- Renk Paleti ---
        const colorPalette = [
            '#007bff', '#dc3545', '#28a745', '#ffc107', '#17a2b8', '#6f42c1', '#fd7e14'
        ];

        let audioCtx = null;
        let activityQueue = [];
        let currentActivityIndex = 0;
        let grandTotalActivities = 0; 
        let scoreCorrect = 0;
        let scoreIncorrect = 0;
        let currentTouchEventItem = null; 
        let isDragging = false; // YENƒ∞: S√ºr√ºkleme durumunu takip et
        let offsetX = 0;        // YENƒ∞: Parmaƒüƒ±n kelime i√ßindeki X konumu
        let offsetY = 0;        // YENƒ∞: Parmaƒüƒ±n kelime i√ßindeki Y konumu
        
        let currentTour = 1; // YENƒ∞: Tur sayacƒ±
        
        // --- Tam Ekran ---
        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.error(`Tam ekrana ge√ßilemedi: ${err.message} (${err.name})`);
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        // --- Ses (Sin√ºs Dalgasƒ±) ---
        function initAudioContext() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
        }
        
        function playSound(type) {
            if (!audioCtx) return; 
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            const now = audioCtx.currentTime;

            if (type === 'touch') { 
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(200, now);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.1);
                oscillator.start(now);
                oscillator.stop(now + 0.1);
            } else if (type === 'correct') { 
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(440, now);
                oscillator.frequency.linearRampToValueAtTime(880, now + 0.2); 
                gainNode.gain.setValueAtTime(0.15, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.2);
                oscillator.start(now);
                oscillator.stop(now + 0.2);
            } else if (type === 'incorrect') { 
                // YENƒ∞: Hata sesi g√ºncellendi
                oscillator.type = 'square'; 
                oscillator.frequency.setValueAtTime(164.81, now); 
                gainNode.gain.setValueAtTime(0.15, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.2); 
                oscillator.start(now);
                oscillator.stop(now + 0.2); 
            }
        }
        
        document.body.addEventListener('click', initAudioContext, { once: true });

        // --- Karƒ±≈ütƒ±rƒ±cƒ± ---
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- YENƒ∞: A≈üamalƒ± Zorluk (Tur) Fonksiyonu ---
        function createActivityQueue() {
            let sentencesForThisRound = [];
            
            if (currentTour == 1) {
                // 1. Tur: 3-4 kelime
                sentencesForThisRound = activitiesData.filter(item => item.w.length == 3 || item.w.length == 4);
            } else if (currentTour == 2) {
                // 2. Tur: 5-6 kelime
                sentencesForThisRound = activitiesData.filter(item => item.w.length == 5 || item.w.length == 6);
            } else {
                // 3. Tur (ve sonrasƒ±): 7+ kelime
                sentencesForThisRound = activitiesData.filter(item => item.w.length >= 7);
                
                // Eƒüer 7+ kelimelik yeterli soru yoksa (veya bittiyse),
                // t√ºm listeyi al ve turu ba≈üa sar.
                if (sentencesForThisRound.length < 5) { 
                    sentencesForThisRound = [...activitiesData];
                    currentTour = 0; // restartGame'de ++ olacaƒüƒ± i√ßin 0'a √ßekilir
                }
            }

            // Se√ßilen zorluk grubunu karƒ±≈ütƒ±r ve 10 tane al
            activityQueue = shuffle(sentencesForThisRound).slice(0, 10); 
            grandTotalActivities = activityQueue.length;
        }

        // --- Etkinlik Y√ºkleyici ---
        function loadActivity() {
            activityArea.innerHTML = '';
            updateProgress();
            
            const activityData = activityQueue[currentActivityIndex]; 
            // Y√∂nerge metni g√ºncellendi
            instructionText.textContent = "ŸÇŸêŸäŸéŸÖŸä | ÿ±Ÿéÿ™ŸêŸëÿ® ÿßŸÑŸÉŸéŸÑŸêŸÖÿßÿ™ ŸÑŸêÿ™ŸéŸÉŸíŸàŸäŸÜ ÿ¨ŸèŸÖŸíŸÑŸéÿ©‚Ä´.‚Ä¨";
            buildScramble(activityData);
        }
        
        // --- Tƒ±klayarak Kelime Ta≈üƒ±ma ---
        function handleWordClick(e) {
            if (isDragging) return; // YENƒ∞: Eƒüer bir s√ºr√ºkleme i≈ülemiyse, tƒ±klamayƒ± yoksay
            const wordItem = e.currentTarget; 
            
            if (wordItem.draggable === false) return;

            const dropZone = document.getElementById('drop-zone');
            const dragZone = document.getElementById('drag-zone');

            if (wordItem.parentElement === dragZone) {
                dropZone.appendChild(wordItem);
            } else if (wordItem.parentElement === dropZone) {
                dragZone.appendChild(wordItem);
            }
            
            playSound('touch'); 
        }

        // --- Aray√ºz√º Olu≈ütur ---
        function buildScramble(data) {
            const scrambleContainer = document.createElement('div');
            scrambleContainer.className = 'scramble-container';

            const dropZone = document.createElement('div');
            dropZone.id = 'drop-zone';
            dropZone.className = 'drop-zone';

            const dragZone = document.createElement('div');
            dragZone.id = 'drag-zone';
            dragZone.className = 'drag-zone';

            const shuffledWords = shuffle([...data.w]);
            shuffledWords.forEach((word, index) => {
                const wordItem = document.createElement('div');
                wordItem.className = 'word-item';
                wordItem.textContent = word;
                wordItem.id = `word-${index}`;
                wordItem.draggable = true;
                wordItem.style.backgroundColor = colorPalette[index % colorPalette.length];
                
                wordItem.addEventListener('click', handleWordClick);
                
                dragZone.appendChild(wordItem);
            });

            const controls = document.createElement('div');
            controls.className = 'scramble-controls';
            
            const checkButton = document.createElement('button');
            checkButton.id = 'check-scramble-btn';
            checkButton.textContent = '‚úî ÿ™Ÿéÿ≠ŸéŸÇŸéŸëŸÇŸí'; // Metin g√ºncellendi
            checkButton.onclick = () => {
                playSound('touch');
                checkScrambleAnswer(data.s); 
            };
            
            const resetButton = document.createElement('button');
            resetButton.id = 'reset-scramble-btn';
            resetButton.textContent = 'üîÑ ÿ•ŸêÿπÿßÿØŸéÿ©'; 
            resetButton.onclick = () => {
                playSound('touch');
                loadActivity(); 
            };
            
            const nextButton = document.createElement('button');
            nextButton.id = 'next-activity-btn';
            nextButton.style.display = 'none'; 
            nextButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11h12.17l-5.59-5.59L12 4l8 8-8 8-1.41-1.41L16.17 13H4v-2z"/></svg>`; 
            nextButton.onclick = () => {
                playSound('touch');
                nextActivity();
            };

            controls.appendChild(checkButton);
            controls.appendChild(resetButton);
            controls.appendChild(nextButton); 
            
            scrambleContainer.appendChild(dropZone);
            scrambleContainer.appendChild(dragZone);
            scrambleContainer.appendChild(controls);
            activityArea.appendChild(scrambleContainer);

            addDragDropListeners();
        }
        
        // --- S√ºr√ºklemeyi ve Tƒ±klamayƒ± Devre Dƒ±≈üƒ± Bƒ±rak/Aktif Et ---
        function toggleWordDrag(enable) {
            document.querySelectorAll('.word-item').forEach(item => {
                item.draggable = enable;
                item.style.cursor = enable ? 'grab' : 'default'; 
                if (!enable) {
                    item.classList.remove('dragging'); 
                }
            });
            currentTouchEventItem = null; 
        }

        // --- Cevap Kontrol√º (Efektlerle) ---
        function checkScrambleAnswer(correctAnswers) {
            const dropZone = document.getElementById('drop-zone');
            const words = Array.from(dropZone.children).map(item => item.textContent);
            const userAnswer = words.join(' ');
            
            const isCorrect = correctAnswers.includes(userAnswer);
            
            dropZone.classList.remove('drop-zone-correct', 'drop-zone-incorrect');
            
            if (isCorrect) {
                scoreCorrect++;
                playSound('correct'); 
                dropZone.classList.add('drop-zone-correct'); 
                
                document.getElementById('check-scramble-btn').style.display = 'none';
                document.getElementById('reset-scramble-btn').style.display = 'none';
                document.getElementById('next-activity-btn').style.display = 'flex';
                
                toggleWordDrag(false); 
                
            } else {
                scoreIncorrect++;
                playSound('incorrect'); 
                dropZone.classList.add('drop-zone-incorrect'); 
                
                setTimeout(() => {
                    dropZone.classList.remove('drop-zone-incorrect');
                }, 400); 
            }
        }

        // --- Sonraki Etkinlik ---
        function nextActivity() {
            currentActivityIndex++; 

            if (currentActivityIndex === grandTotalActivities) {
                showFinishScreen();
            } else {
                loadActivity();
            }
        }

        // --- Biti≈ü Ekranƒ± ---
        function showFinishScreen() {
            activityArea.innerHTML = `
                <div id="finish-screen">
                    <p>ÿ£Ÿéÿ≠Ÿíÿ≥ŸéŸÜŸíÿ™! ŸÑŸéŸÇŸéÿØ ÿ£ŸéŸÉŸíŸÖŸéŸÑŸíÿ™Ÿé ÿ¨ŸéŸÖŸäÿπ ÿßŸÑÿ£ŸéŸÜŸíÿ¥Ÿêÿ∑Ÿéÿ©‚Ä´.‚Ä¨</p>
                    
                    <div class="score-display">
                        <span class="score-item score-correct">‚úî ${scoreCorrect}</span>
                        <span class="score-item score-incorrect">‚ùå ${scoreIncorrect}</span>
                    </div>

                    <button id="replay-button" onclick="restartGame()">üîÑ</button>
                </div>
            `;
            instructionText.textContent = "ÿßŸêŸÜŸíÿ™ŸéŸáŸéÿ™ ÿßŸÑÿ£ŸéŸÜŸíÿ¥Ÿêÿ∑Ÿéÿ©";
            progressDisplay.textContent = "ÿßŸêŸÉŸíÿ™ŸéŸÖŸéŸÑ";
            progressBar.style.width = '100%';
            progressBar.style.backgroundColor = 'var(--success-color)';
        }
        
        // --- Yeniden Ba≈ülat ---
        function restartGame() {
            playSound('touch');
            scoreCorrect = 0;
            scoreIncorrect = 0;
            currentActivityIndex = 0; 
            currentTour++; // YENƒ∞: Sonraki tura ge√ß
            
            progressBar.style.width = '0%';
            progressBar.style.backgroundColor = 'var(--accent-color)';
            
            createActivityQueue(); // YENƒ∞: Bir sonraki turun sorularƒ±nƒ± y√ºkle
            loadActivity(); 
        }

        // --- ƒ∞lerleme G√ºncelleme ---
        function updateProgress() {
            if (grandTotalActivities === 0) {
                 progressDisplay.textContent = `0 / ${grandTotalActivities}`;
                 return;
            }
            if (currentActivityIndex === grandTotalActivities) return; 

            const currentQuestionNum = currentActivityIndex + 1;
            const progressPercent = (currentActivityIndex / grandTotalActivities) * 100;
            
            progressDisplay.textContent = `${currentQuestionNum} / ${grandTotalActivities}`;
            progressBar.style.width = `${progressPercent}%`;
        }
        
       // --- S√ºr√ºkle-Bƒ±rak Olaylarƒ± ---
        function addDragDropListeners() {
            const draggables = document.querySelectorAll('.word-item');
            const containers = [
                document.getElementById('drop-zone'), 
                document.getElementById('drag-zone')
            ];

            // 1. Fare Olaylarƒ± (Aynƒ± kalabilir)
            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', (e) => {
                    if (!e.currentTarget.draggable) { 
                        e.preventDefault();
                        return;
                    }
                    e.currentTarget.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', e.currentTarget.id);
                });
                draggable.addEventListener('dragend', (e) => {
                    e.currentTarget.classList.remove('dragging');
                });
            });

            // 2. Bƒ±rakma Olaylarƒ± (Aynƒ± kalabilir)
            containers.forEach(container => {
                container.addEventListener('dragover', (e) => { e.preventDefault(); });
                container.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const id = e.dataTransfer.getData('text/plain');
                    const draggable = document.getElementById(id);
                    if (draggable && draggable.draggable) { 
                        container.appendChild(draggable);
                        draggable.classList.remove('dragging');
                    }
                });
            });
            
            // 3. YENƒ∞ Dokunmatik Olaylarƒ± (touchstart g√ºncellendi)
            draggables.forEach(draggable => {
                draggable.addEventListener('touchstart', (e) => {
                    if (!e.currentTarget.draggable) return; 

                    currentTouchEventItem = e.currentTarget;
                    const touch = e.touches[0];
                    const rect = currentTouchEventItem.getBoundingClientRect();

                    // Parmaƒüƒ±n kelimenin sol √ºst k√∂≈üesine g√∂re ofsetini hesapla
                    offsetX = touch.clientX - rect.left;
                    offsetY = touch.clientY - rect.top;

                    // S√ºr√ºkleme ba≈üladƒ±ƒüƒ±nda 'dragging' sƒ±nƒ±fƒ±nƒ± ekle
                    currentTouchEventItem.classList.add('dragging');
                    
                    // Not: isDragging = true; hen√ºz ayarlanmadƒ±.
                    // Bu, 'touchmove' olayƒ± ger√ßekle≈üene kadar bekler.
                    // Bu sayede, s√ºr√ºklemesiz kƒ±sa dokunu≈ülar 'click' olarak √ßalƒ±≈üabilir.

                }, { passive: true }); // passive:true performansƒ± artƒ±rƒ±r
            });
        }
        
        // Global Dokunmatik Dinleyicileri
        function setupGlobalTouchListeners() {
             document.addEventListener('touchmove', (e) => {
                if (!currentTouchEventItem) return;

                // ƒ∞lk hareket algƒ±landƒ±ƒüƒ±nda s√ºr√ºklemeyi ba≈ülat
                if (!isDragging) {
                    isDragging = true;
                    // √ñƒüeyi "havaya kaldƒ±r"
                    currentTouchEventItem.style.position = 'fixed'; // Veya 'absolute'
                    currentTouchEventItem.style.zIndex = '1000';
                    // elementFromPoint'in √ßalƒ±≈ümasƒ± i√ßin ge√ßici olarak devre dƒ±≈üƒ± bƒ±rak
                    currentTouchEventItem.style.pointerEvents = 'none'; 
                }

                const touch = e.touches[0];
                
                // Ofseti kullanarak √∂ƒüeyi parmaƒüƒ±n altƒ±na konumlandƒ±r
                let newX = touch.clientX - offsetX;
                let newY = touch.clientY - offsetY;
                
                currentTouchEventItem.style.left = `${newX}px`;
                currentTouchEventItem.style.top = `${newY}px`;
                
                // S√ºr√ºklerken sayfanƒ±n kaymasƒ±nƒ± engelle
                e.preventDefault(); 
            }, { passive: false }); // preventDefault √ßaƒürƒ±ldƒ±ƒüƒ± i√ßin 'false' olmalƒ±

            document.addEventListener('touchend', (e) => {
                if (!currentTouchEventItem) return;

                // Eƒüer bir s√ºr√ºkleme i≈ülemi ger√ßekle≈ütiyse
                if (isDragging) {
                    const touch = e.changedTouches[0];
                    
                    // Parmaƒüƒ±n altƒ±ndaki √∂ƒüeyi bul
                    const dropTarget = document.elementFromPoint(touch.clientX, touch.clientY);
                    
                    // √ñƒüenin stillerini sƒ±fƒ±rla (DOM'a geri eklemeden √∂nce)
                    currentTouchEventItem.style.position = '';
                    currentTouchEventItem.style.left = '';
                    currentTouchEventItem.style.top = '';
                    currentTouchEventItem.style.zIndex = '';
                    currentTouchEventItem.style.pointerEvents = '';

                    let validDropZone = null;
                    if (dropTarget) {
                        if (dropTarget.classList.contains('drop-zone')) validDropZone = dropTarget;
                        else if (dropTarget.classList.contains('drag-zone')) validDropZone = dropTarget;
                        else if (dropTarget.closest('.drop-zone')) validDropZone = dropTarget.closest('.drop-zone');
                        else if (dropTarget.closest('.drag-zone')) validDropZone = dropTarget.closest('.drag-zone');
                    }
                    
                    // Ge√ßerli bir alana bƒ±rakƒ±ldƒ±ysa oraya ekle
                    if (validDropZone) {
                        validDropZone.appendChild(currentTouchEventItem);
                    }
                    // Not: Eƒüer ge√ßerli bir alana bƒ±rakƒ±lmazsa, √∂ƒüe eski yerine "d√∂nmez",
                    // √ß√ºnk√º biz onu 'fixed' yaparak DOM akƒ±≈üƒ±ndan √ßƒ±karmƒ±≈ütƒ±k.
                    // Mevcut mantƒ±ƒüƒ±nƒ±zda da geri d√∂nme yoktu, bu y√ºzden bu kabul edilebilirdir.
                }

                // Sƒ±nƒ±fƒ± ve deƒüi≈ükenleri her zaman sƒ±fƒ±rla
                currentTouchEventItem.classList.remove('dragging');
                currentTouchEventItem = null;
                isDragging = false;
                offsetX = 0;
                offsetY = 0;
            });
        }

        // --- Ba≈ülangƒ±√ß ---
        document.addEventListener('DOMContentLoaded', () => {
             // Veri setini temizle
            activitiesData.forEach(round => {
                // (Hatalƒ± harfleri d√ºzelt)
                round.w = round.w.map(word => 
                    word.replace('ŸäŸéÿ≥ŸíÿπŸédan', 'ŸäŸéÿ≥ŸíÿπŸéÿØÿßŸÜ')
                        .replace('ÿßŸÑŸíŸÅŸéÿ±ŸéJŸê', 'ÿßŸÑŸíŸÅŸéÿ±Ÿéÿ¨Ÿê')
                        .replace('t√ºin√º', 'ÿ™ŸèÿπŸäŸÜŸè')
                        .replace('ÿßŸÑŸÖŸéÿ∑Ÿíÿ®Ÿéx', 'ÿßŸÑŸÖŸéÿ∑Ÿíÿ®ŸéÿÆ')
                        .replace('ŸàŸéŸäŸéÿ∂ŸíhŸéŸÉŸàŸÜŸé', 'ŸàŸéŸäŸéÿ∂Ÿíÿ≠ŸéŸÉŸàŸÜŸé')
                );
                round.s = round.s.map(s_item => 
                    s_item.replace('ŸäŸéÿ≥ŸíÿπŸédan', 'ŸäŸéÿ≥ŸíÿπŸéÿØÿßŸÜ')
                          .replace('ÿßŸÑŸíŸÅŸéÿ±ŸéJŸê', 'ÿßŸÑŸíŸÅŸéÿ±Ÿéÿ¨Ÿê')
                          .replace('t√ºin√º', 'ÿ™ŸèÿπŸäŸÜŸè')
                          .replace('ÿßŸÑŸÖŸéÿ∑Ÿíÿ®Ÿéx', 'ÿßŸÑŸÖŸéÿ∑Ÿíÿ®ŸéÿÆ')
                          .replace('ŸàŸéŸäŸéÿ∂ŸíhŸéŸÉŸàŸÜŸé', 'ŸàŸéŸäŸéÿ∂Ÿíÿ≠ŸéŸÉŸàŸÜŸé')
                );
                // Noktalarƒ± kaldƒ±r
                round.w = round.w.map(word => word.replace(/\.$/, ''));
                round.s = round.s.map(s_item => s_item.replace(/\.$/, ''));
            });
            
            // Tam Ekran
            const fullscreenBtn = document.getElementById('fullscreen-btn');
            if (fullscreenBtn) {
                fullscreenBtn.addEventListener('click', toggleFullScreen);
            }
            document.addEventListener('fullscreenchange', () => {
                if (document.fullscreenElement) {
                    document.body.classList.add('fullscreen');
                } else {
                    document.body.classList.remove('fullscreen');
                }
            });
            
            createActivityQueue(); // 1. Turu (kolay) y√ºkle
            loadActivity();
            setupGlobalTouchListeners(); 
        });

    </script>
</body>
</html>