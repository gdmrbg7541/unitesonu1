<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù‚ÙÙŠÙÙ…ÙŠ - Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- Temel Sayfa Stilleri --- */
        :root {
            --accent-color: #0d6efd; 
            --success-color: #28a745;
            --danger-color: #dc3545;
            --bg-light: #f8f9fa;
            --font-arabic: 'Noto Naskh Arabic', 'Tahoma', 'Arial', sans-serif;
            
            --grid-size-cols: 10;
            /* DEÄÄ°ÅÄ°KLÄ°K: SatÄ±r sayÄ±sÄ± 8'e dÃ¼ÅŸÃ¼rÃ¼ldÃ¼ */
            --grid-size-rows: 8;
        }

        body {
            font-family: var(--font-arabic);
            background-color: #e9ecef;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            font-weight: 400;
        }

        /* --- Ana Etkinlik AlanÄ± --- */
        .activity-container {
            position: relative;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            width: 90vw;
            height: calc(90vw * 9 / 16); /* 16:9 */
            max-height: 90vh;
            max-width: calc(90vh * 16 / 9); /* 16:9 */
        }
        
        /* --- Header --- */
        .header {
            padding: 15px 25px;
            border-bottom: 1px solid #dee2e6;
            display: grid;
            grid-template-areas: "replay instruction back"; 
            grid-template-columns: 80px 1fr 80px;
            align-items: center;
            gap: 20px;
            flex-shrink: 0;
        }

        #instruction-text {
            grid-area: instruction;
            text-align: center; 
            font-size: 2.2rem; 
            font-weight: 700;
            color: #555;
        }

        .header-button-container {
            display: flex;
            justify-content: center; 
        }
        .header-button-container.left { grid-area: replay; justify-content: flex-start; }
        .header-button-container.right { grid-area: back; justify-content: flex-end; }

        .icon-button {
            background: #f0f0f0;
            color: #555;
            border: 1px solid #ccc;
            border-radius: 1.5vmin;
            cursor: pointer;
            width: clamp(40px, 8vmin, 55px);
            height: clamp(40px, 8vmin, 55px);
            padding: 0;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem; 
        }
        .icon-button:hover {
            background: #e0e0e0;
        }
        .icon-button svg {
            width: clamp(24px, 5vmin, 30px);
            height: clamp(24px, 5vmin, 30px);
            fill: currentColor;
        }


        /* --- AsÄ±l Etkinlik AlanÄ± --- */
        .activity-area {
            flex-grow: 1;
            /* DEÄÄ°ÅÄ°KLÄ°K: Yatay padding 5px'e dÃ¼ÅŸÃ¼rÃ¼ldÃ¼ */
            padding: 15px 5px; 
            overflow: hidden;
            
            display: flex;
            flex-direction: column; 
            gap: 15px;
            
            justify-content: flex-start;
            align-items: center;
        }

        /* --- Izgara Stilleri --- */
        #puzzle-grid-container {
            flex-grow: 1;
            height: 100%;
            max-height: 100%; 
            /* DEÄÄ°ÅÄ°KLÄ°K: En-boy oranÄ± 10x8'e ayarlandÄ± */
            aspect-ratio: 10 / 8; 
            
            display: grid;
            grid-template-columns: repeat(var(--grid-size-cols), 1fr);
            grid-template-rows: repeat(var(--grid-size-rows), 1fr);
            gap: 0; 
            background-color: #ccc; 
            border: 3px solid #666; 
            border-radius: 8px;
            overflow: hidden; 
            
            user-select: none;
            box-sizing: border-box; 
        }
        
        .grid-cell {
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            /* DEÄÄ°ÅÄ°KLÄ°K: Font boyutu 8 satÄ±ra gÃ¶re ayarlandÄ± (biraz bÃ¼yÃ¼tÃ¼ldÃ¼) */
            font-size: 4.5vmin; 
            font-weight: 700;
            color: #333;
            cursor: pointer;
            border-bottom: 3px solid #999; 
            border-left: 3px solid #999; 
            box-sizing: border-box;
        }
        #puzzle-grid-container .grid-cell:nth-child(var(--grid-size-cols)n) {
            border-right: none;
        }
        #puzzle-grid-container .grid-cell:nth-child(-n + var(--grid-size-cols)) {
            border-top: none;
        }

        
        /* SeÃ§im VurgularÄ± */
        .grid-cell.selecting {
            background-color: #b3d4fc; 
            transition: background-color 0.05s ease;
        }
        
        .grid-cell.found {
            color: white;
            transition: background-color 0.3s ease;
        }


        /* --- Kelime Listesi Stilleri --- */
        #word-list-container {
            flex-basis: auto; 
            width: 100%;
            flex-shrink: 0;
            background-color: var(--bg-light);
            border-radius: 8px;
            padding: 10px;
            overflow-y: auto;
            box-sizing: border-box;
        }
        
        #word-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap; 
            justify-content: center;
            gap: 10px 20px; /* Dikey / Yatay boÅŸluk */
        }

        .word-list-item {
            /* DEÄÄ°ÅÄ°KLÄ°K: Font boyutu kÃ¼Ã§Ã¼ltÃ¼ldÃ¼ */
            font-size: 1.8rem; 
            font-weight: 700;
            color: #555;
            transition: all 0.3s ease;
            
            /* DEÄÄ°ÅÄ°KLÄ°K: Araya Ã§izgi eklendi (RTL iÃ§in sol taraf) */
            border-left: 1px solid #ccc;
            padding-left: 15px;
        }
        
        /* DEÄÄ°ÅÄ°KLÄ°K: Listenin son elemanÄ±ndan Ã§izgiyi kaldÄ±r */
        .word-list-item:last-child {
            border-left: none;
            padding-left: 0;
        }
        
        .word-list-item.found {
            text-decoration: line-through;
            opacity: 0.7;
        }


        /* --- Geri Bildirim EkranÄ± (âœ” / âŒ) --- */
        .feedback-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 15rem;
            z-index: 200;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease;
            flex-direction: column;
        }
        .feedback-overlay.show {
            visibility: visible;
            opacity: 1;
        }
        .feedback-overlay .correct { color: var(--success-color); }
        
        #replay-button-end {
            display: none; 
            font-size: 4.5rem; 
            background: none;
            border: none;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            transition: transform 0.2s ease, background-color 0.2s ease;
            margin-top: 20px;
        }
        #replay-button-end:hover {
            transform: rotate(-90deg);
            background-color: #f0f0f0;
        }
        .feedback-overlay.show #replay-button-end {
            display: block;
        }
        

        /* --- Mobil DÃ¼zen --- */
        @media (orientation: portrait) {
            .activity-container {
                width: 95vw;
                height: calc(95vw * 16 / 9); /* 9:16 */
                max-height: 95vh;
                max-width: calc(95vh * 9 / 16); /* 9:16 */
            }

            .header {
                grid-template-columns: 60px 1fr 60px;
                gap: 10px;
                padding: 10px 15px;
            }
            #instruction-text { font-size: 1.4rem; }
            .icon-button { width: 45px; height: 45px; }
            
            .activity-area {
                gap: 10px;
            }
            
            #word-list-container {
                flex-basis: auto; 
                flex-shrink: 1;
                max-height: 120px; 
            }
            #word-list {
                gap: 5px 15px;
            }
            /* DEÄÄ°ÅÄ°KLÄ°K: Mobil font boyutu kÃ¼Ã§Ã¼ltÃ¼ldÃ¼ */
            .word-list-item { 
                font-size: 1.7rem; 
                padding-left: 10px;
            }
            
            #puzzle-grid-container {
                flex-grow: 1; 
                width: 100%;
                height: auto;
                 /* DEÄÄ°ÅÄ°KLÄ°K: Mobil en-boy oranÄ± 10x8'e ayarlandÄ± */
                aspect-ratio: 10 / 8;
                max-height: none; 
            }
            
            .grid-cell {
                 /* DEÄÄ°ÅÄ°KLÄ°K: 8 satÄ±ra gÃ¶re ayarlandÄ± */
                 font-size: 6.5vmin; 
            }
        }

    </style>
</head>
<body>

    <div class="activity-container">
        
        <div class="header">
            <div class="header-button-container left">
                <button class="icon-button" id="replay-button-header" onclick="restartGame()">ğŸ”„</button>
            </div>
            
            <div id="instruction-text">Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª</div>

            <div class="header-button-container right">
                <a href="index.html" class="icon-button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                </a>
            </div>
        </div>

        <div class="activity-area">
            
            <div id="word-list-container">
                <ul id="word-list">
                </ul>
            </div>
            
            <div id="puzzle-grid-container" oncontextmenu="return false;">
            </div>
            
        </div>

        <div class="feedback-overlay" id="feedback-overlay">
            <span id="feedback-icon"></span>
            <button id="replay-button-end" onclick="restartGame()">ğŸ”„</button>
        </div>

    </div>

    <script>
        // --- Renk Paleti ve Kelime Verisi ---
        const wordData = [
            { word: 'Ù…Ø³Ø¬Ø¯', color: '#dc3545', emoji: 'ğŸ•Œ' },
            { word: 'Ø·Ø¨ÙŠØ¨', color: '#fd7e14', emoji: 'ğŸ§‘â€âš•ï¸' },
            { word: 'Ø¨ÙŠØª', color: '#ffc107', emoji: 'ğŸ ' },
            { word: 'Ù‚Ù„Ù…', color: '#28a745', emoji: 'ğŸ–Šï¸' },
            { word: 'ÙƒØªØ§Ø¨', color: '#20c997', emoji: 'ğŸ“–' },
            { word: 'Ø³ÙŠØ§Ø±Ø©', color: '#0d6efd', emoji: 'ğŸš—' },
            { word: 'Ù…Ø¯Ø±Ø³Ø©', color: '#6f42c1', emoji: 'ğŸ«' },
            { word: 'Ø¨Ø§Ø¨', color: '#e83e8c', emoji: 'ğŸšª' }
        ];
        
        const wordsToFind = wordData.map(data => data.word);
        
        const arabicLetters = 'Ø£Ø¨ØªØ«Ø¬Ø­Ø®Ø¯Ø°Ø±Ø²Ø³Ø´ØµØ¶Ø·Ø¸Ø¹ØºÙÙ‚ÙƒÙ„Ù…Ù†Ù‡ÙˆÙŠ'.split('');
        
        const gridSizeCols = 10;
        /* DEÄÄ°ÅÄ°KLÄ°K: SatÄ±r sayÄ±sÄ± 8'e dÃ¼ÅŸÃ¼rÃ¼ldÃ¼ */
        const gridSizeRows = 8;

        // --- Gerekli Elementler ---
        const gridContainer = document.getElementById('puzzle-grid-container');
        const wordListElement = document.getElementById('word-list');
        const instructionText = document.getElementById('instruction-text');
        const feedbackOverlay = document.getElementById('feedback-overlay');
        const feedbackIcon = document.getElementById('feedback-icon');
        
        // --- Ses DeÄŸiÅŸkenleri ---
        let audioCtx = null;

        // --- Durum DeÄŸiÅŸkenleri ---
        let grid = []; // 2D array
        let gridCells = []; // HTML elementleri
        let foundWords = [];
        
        let isSelecting = false;
        let selectionStart = null; // {row, col}
        let currentSelection = []; // Elementler

        // --- SES FONKSÄ°YONLARI ---
        function initAudioContext() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
        }
        
        function playSound(type) {
            if (!audioCtx) return; 
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            const now = audioCtx.currentTime;

            if (type === 'select') { 
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(400, now);
                gainNode.gain.setValueAtTime(0.05, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.1);
                oscillator.start(now);
                oscillator.stop(now + 0.1);
            } else if (type === 'correct') {
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(440, now);
                oscillator.frequency.linearRampToValueAtTime(880, now + 0.2);
                gainNode.gain.setValueAtTime(0.15, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.2);
                oscillator.start(now);
                oscillator.stop(now + 0.2);
            } else if (type === 'incorrect') {
                oscillator.type = 'triangle'; 
                oscillator.frequency.setValueAtTime(200, now);
                oscillator.frequency.linearRampToValueAtTime(100, now + 0.2);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.2);
                oscillator.start(now);
                oscillator.stop(now + 0.2);
            }
        }
        
        document.body.addEventListener('click', initAudioContext, { once: true });


        // --- OYUN KURULUMU ---

        function initializeGame() {
            // Durumu sÄ±fÄ±rla
            foundWords = [];
            grid = [];
            gridCells = [];
            gridContainer.innerHTML = '';
            wordListElement.innerHTML = '';
            feedbackOverlay.classList.remove('show');
            instructionText.textContent = "Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª";

            // 1. Kelime listesini oluÅŸtur
            renderWordList();
            
            // 2. BoÅŸ Ä±zgara oluÅŸtur (DEÄÄ°ÅÄ°KLÄ°K: 8x10)
            for (let r = 0; r < gridSizeRows; r++) {
                grid[r] = [];
                gridCells[r] = [];
                for (let c = 0; c < gridSizeCols; c++) {
                    grid[r][c] = null;
                }
            }

            // 3. Kelimeleri yerleÅŸtir
            placeWords();

            // 4. BoÅŸluklarÄ± doldur
            fillEmptyCells();

            // 5. IzgarayÄ± HTML'e dÃ¶k
            renderGrid();
        }

        function renderWordList() {
            wordData.forEach(data => {
                const li = document.createElement('li');
                li.className = 'word-list-item';
                li.id = `word-${data.word}`;
                li.textContent = `${data.emoji} ${data.word}`;
                li.dataset.color = data.color; 
                wordListElement.appendChild(li);
            });
        }
        
        function placeWords() {
            const directions = [
                { dr: 0, dc: 1 },  // Yatay
                { dr: 1, dc: 0 },  // Dikey
                { dr: 1, dc: 1 }   // Ã‡apraz
            ];

            for (const word of wordsToFind) {
                let placed = false;
                let attempts = 0;
                
                while (!placed && attempts < 100) {
                    attempts++;
                    const dir = directions[Math.floor(Math.random() * directions.length)];
                    // DEÄÄ°ÅÄ°KLÄ°K: 8x10'a gÃ¶re rastgele yer seÃ§
                    const r = Math.floor(Math.random() * gridSizeRows);
                    const c = Math.floor(Math.random() * gridSizeCols);

                    if (canPlaceWord(word, r, c, dir)) {
                        for (let i = 0; i < word.length; i++) {
                            grid[r + i * dir.dr][c + i * dir.dc] = word[i];
                        }
                        placed = true;
                    }
                }
            }
        }
        
        function canPlaceWord(word, r, c, dir) {
            for (let i = 0; i < word.length; i++) {
                const newRow = r + i * dir.dr;
                const newCol = c + i * dir.dc;

                // DEÄÄ°ÅÄ°KLÄ°K: 8x10 sÄ±nÄ±r kontrolÃ¼
                if (newRow >= gridSizeRows || newCol >= gridSizeCols || newRow < 0 || newCol < 0) {
                    return false;
                }
                const cell = grid[newRow][newCol];
                if (cell !== null && cell !== word[i]) { 
                    return false;
                }
            }
            return true;
        }

        function fillEmptyCells() {
            // DEÄÄ°ÅÄ°KLÄ°K: 8x10 dÃ¶ngÃ¼
            for (let r = 0; r < gridSizeRows; r++) {
                for (let c = 0; c < gridSizeCols; c++) {
                    if (grid[r][c] === null) {
                        grid[r][c] = arabicLetters[Math.floor(Math.random() * arabicLetters.length)];
                    }
                }
            }
        }

        function renderGrid() {
            // DEÄÄ°ÅÄ°KLÄ°K: 8x10 dÃ¶ngÃ¼
            for (let r = 0; r < gridSizeRows; r++) {
                for (let c = 0; c < gridSizeCols; c++) {
                    const cell = document.createElement('div');
                    cell.className = 'grid-cell';
                    cell.textContent = grid[r][c];
                    cell.dataset.row = r;
                    cell.dataset.col = c;
                    
                    cell.addEventListener('mousedown', handleSelectionStart);
                    cell.addEventListener('mouseover', handleSelectionMove);
                    
                    gridContainer.appendChild(cell);
                    gridCells[r][c] = cell; 
                }
            }
            document.addEventListener('mouseup', handleSelectionEnd);
            
            gridContainer.addEventListener('touchstart', (e) => handleSelectionStart(e.touches[0]), { passive: false });
            gridContainer.addEventListener('touchmove', (e) => handleSelectionMove(e.touches[0]), { passive: false });
            gridContainer.addEventListener('touchend', handleSelectionEnd);
        }

        // --- SEÃ‡Ä°M MANTIÄI ---
        
        function getCellFromEvent(e) {
             if (e.target && e.target.classList.contains('grid-cell')) {
                return e.target;
            }
            if (e.clientX && e.clientY) {
                return document.elementFromPoint(e.clientX, e.clientY);
            }
            return null;
        }

        function handleSelectionStart(e) {
            e.preventDefault();
            const cell = getCellFromEvent(e);
            if (!cell || !cell.dataset) return;

            isSelecting = true;
            selectionStart = { row: parseInt(cell.dataset.row), col: parseInt(cell.dataset.col) };
            currentSelection = [cell];
            cell.classList.add('selecting');
            playSound('select');
        }

        function handleSelectionMove(e) {
            if (!isSelecting) return;
            e.preventDefault();
            
            const cell = getCellFromEvent(e);
            if (!cell || !cell.dataset) return;

            currentSelection.forEach(c => c.classList.remove('selecting'));
            
            const start = selectionStart;
            const end = { row: parseInt(cell.dataset.row), col: parseInt(cell.dataset.col) };

            currentSelection = getCellsInLine(start, end);
            currentSelection.forEach(c => c.classList.add('selecting'));
        }

        function handleSelectionEnd() {
            if (!isSelecting) return;
            isSelecting = false;
            
            checkSelection();
            
            currentSelection.forEach(c => c.classList.remove('selecting'));
            currentSelection = [];
            selectionStart = null;
        }
        
        function getCellsInLine(start, end) {
            const line = [];
            const dr = Math.sign(end.row - start.row);
            const dc = Math.sign(end.col - start.col);

            if (dr === 0 || dc === 0 || Math.abs(dr) === Math.abs(dc)) {
                 let r = start.row;
                 let c = start.col;
                 while (true) {
                     if (gridCells[r] && gridCells[r][c]) {
                         line.push(gridCells[r][c]);
                     } else {
                         break;
                     }
                     if (r === end.row && c === end.col) break;
                     r += dr;
                     c += dc;
                 }
            } else {
                 return [gridCells[start.row][start.col]];
            }
            return line;
        }
        
        // --- KONTROL MANTIÄI ---
        
        function checkSelection() {
            if (currentSelection.length < 2) return;
            
            const selectedWord = currentSelection.map(cell => cell.textContent).join('');
            const selectedWordReversed = selectedWord.split('').reverse().join('');
            
            let found = false;
            
            for (const word of wordsToFind) {
                if (foundWords.includes(word)) continue; 
                
                if (word === selectedWord || word === selectedWordReversed) {
                    markAsFound(word); 
                    found = true;
                    break;
                }
            }
            
            if (!found) {
                playSound('incorrect');
            }
        }
        
        function markAsFound(word) {
            playSound('correct');
            
            const listItem = document.getElementById(`word-${word}`);
            const color = listItem.dataset.color;
            
            currentSelection.forEach(cell => {
                cell.classList.add('found');
                cell.style.backgroundColor = color; 
            });
            
            listItem.classList.add('found');
            listItem.style.color = color; 
            
            foundWords.push(word);
            
            if (foundWords.length === wordsToFind.length) {
                showWinScreen();
            }
        }

        // --- BitiÅŸ EkranÄ± ve Yeniden BaÅŸlatma ---
        function showWinScreen() {
            instructionText.textContent = "Ø£ÙØ­Ù’Ø³ÙÙ†Ù’Øª! Ù„ÙÙ‚ÙØ¯ Ø£ÙÙƒÙ’Ù…ÙÙ„Ù’ØªÙ";
            feedbackIcon.textContent = 'âœ”';
            feedbackIcon.className = 'correct';
            feedbackOverlay.classList.add('show');
        }

        function restartGame() {
            playSound('select');
            initializeGame();
        }

        
        // --- BaÅŸlangÄ±Ã§ ---
        document.addEventListener('DOMContentLoaded', () => {
            initializeGame();
        });

    </script>
</body>
</html>