<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ŸÇŸêŸäŸéŸÖŸä - ŸÑÿπÿ®ÿ© ÿßŸÑÿ∞ÿßŸÉÿ±ÿ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- Temel Sayfa Stilleri --- */
        :root {
            --accent-color: #6f42c1; /* Tema rengi (Mor) */
            --success-color: #28a745;
            --danger-color: #dc3545;
            --bg-light: #f8f9fa;
            --font-arabic: 'Noto Naskh Arabic', 'Tahoma', 'Arial', sans-serif;
        }

        body {
            font-family: var(--font-arabic);
            background-color: #e9ecef;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            font-weight: 400;
        }

        /* --- Ana Etkinlik Alanƒ± --- */
        .activity-container {
            position: relative;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            width: 90vw;
            height: calc(90vw * 9 / 16); /* 16:9 */
            max-height: 90vh;
            max-width: calc(90vh * 16 / 9); /* 16:9 */
        }
        
        /* --- Header (Yenileme D√ºƒümesi Eklendi) --- */
        .header {
            padding: 15px 25px;
            border-bottom: 1px solid #dee2e6;
            display: grid;
            grid-template-areas: "replay instruction back"; 
            grid-template-columns: 80px 1fr 80px;
            align-items: center;
            gap: 20px;
            flex-shrink: 0;
        }

        #instruction-text {
            grid-area: instruction;
            text-align: center; 
            font-size: 2.2rem; 
            font-weight: 700;
            color: #555;
        }

        .header-button-container {
            display: flex;
            justify-content: center; /* Butonlarƒ± ortala */
        }
        .header-button-container.left { grid-area: replay; justify-content: flex-start; }
        .header-button-container.right { grid-area: back; justify-content: flex-end; }

        .icon-button {
            background: #f0f0f0;
            color: #555;
            border: 1px solid #ccc;
            border-radius: 1.5vmin;
            cursor: pointer;
            width: clamp(40px, 8vmin, 55px);
            height: clamp(40px, 8vmin, 55px);
            padding: 0;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem; /* Emoji boyutu i√ßin */
        }
        .icon-button:hover {
            background: #e0e0e0;
        }
        .icon-button svg {
            width: clamp(24px, 5vmin, 30px);
            height: clamp(24px, 5vmin, 30px);
            fill: currentColor;
        }


        /* --- Asƒ±l Etkinlik Alanƒ± --- */
        .activity-area {
            flex-grow: 1;
            padding: 15px;
            overflow: auto; /* D√º≈ü√ºk √ß√∂z√ºn√ºrl√ºkte kaydƒ±rma */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- Hafƒ±za Oyunu Stilleri --- */
        
        #game-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 12px;
            
            width: 100%; 
            height: 100%;
            margin: 0 auto;
        }

        .card {
            background-color: transparent;
            cursor: pointer;
            perspective: 1000px; /* 3D √ßevirme i√ßin */
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            border-radius: 10px;
        }

        .card.is-flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-face, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden; /* Arka y√ºz√º gizle */
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            
            /* ƒ∞√ßeriƒüi ortala */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .card-back {
            background-color: var(--accent-color);
            color: white;
            font-size: 8vmin; 
        }

        .card-face {
            background-color: var(--bg-light);
            color: #333;
            transform: rotateY(180deg);
            
            /* D√∂nd√ºƒü√ºnde √ßer√ßeve ekle */
            border: 5px solid var(--accent-color);
            box-sizing: border-box;
        }
        
        /* Kelime ve Emoji i√ßin farklƒ± boyutlandƒ±rma */
        .card-face[data-type="word"] {
            font-size: 4.5vmin; /* Responsive kelime boyutu */
            font-weight: 700;
            padding: 5px;
            text-align: center;
        }
        .card-face[data-type="emoji"] {
            font-size: 7vmin; /* Responsive emoji boyutu */
        }

        
        /* E≈üle≈üen kartlarƒ± hafif√ße soldur */
        .card.is-matched {
            opacity: 0.5;
            cursor: default;
        }


        /* --- Geri Bildirim Ekranƒ± (‚úî / ‚ùå) --- */
        .feedback-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 15rem;
            z-index: 200;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease;
            flex-direction: column;
        }
        .feedback-overlay.show {
            visibility: visible;
            opacity: 1;
        }
        .feedback-overlay .correct { color: var(--success-color); }
        
        /* Yenileme D√ºƒümesi (Biti≈ü ekranƒ± i√ßin) */
        #replay-button-end {
            display: none; /* Varsayƒ±lan olarak gizli */
            font-size: 4.5rem; 
            background: none;
            border: none;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            transition: transform 0.2s ease, background-color 0.2s ease;
            margin-top: 20px;
        }
        #replay-button-end:hover {
            transform: rotate(-90deg);
            background-color: #f0f0f0;
        }
        .feedback-overlay.show #replay-button-end {
            display: block;
        }
        

        /* --- Mobil D√ºzen --- */
        @media (orientation: portrait) {
            .activity-container {
                width: 95vw;
                height: calc(95vw * 16 / 9); /* 9:16 */
                max-height: 95vh;
                max-width: calc(95vh * 9 / 16); /* 9:16 */
            }

            .header {
                grid-template-columns: 60px 1fr 60px;
                gap: 10px;
                padding: 10px 15px;
            }
            #instruction-text { font-size: 1.4rem; }
            .icon-button { width: 45px; height: 45px; }
            
            #game-board {
                gap: 8px;
            }
        }

    </style>
</head>
<body>

    <div class="activity-container">
        
        <div class="header">
            <div class="header-button-container left">
                <button class="icon-button" id="replay-button-header" onclick="restartGame()">üîÑ</button>
            </div>
            
            <div id="instruction-text">...</div> <div class="header-button-container right">
                <a href="index.html" class="icon-button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                </a>
            </div>
        </div>

        <div class="activity-area">
            <div id="game-board">
                </div>
        </div>

        <div class="feedback-overlay" id="feedback-overlay">
            <span id="feedback-icon"></span>
            <button id="replay-button-end" onclick="restartGame()">üîÑ</button>
        </div>

    </div>

    <script>
        // --- DEƒûƒ∞≈ûTƒ∞: 2 Seviyeli Oyun Verisi ('Ÿäÿ∞Ÿáÿ®' yerine 'ÿ¥ÿ±ÿ∑Ÿä') ---
        const levelsData = [
            // Seviye 1 (8 √áift)
            [
                { id: 1, type: 'word', content: 'ÿ¥Ÿèÿ±Ÿíÿ∑ŸêŸäŸë' }, // 'Ÿäÿ∞Ÿáÿ®' deƒüi≈ütirildi
                { id: 1, type: 'emoji', content: 'üëÆ‚Äç‚ôÇÔ∏è' }, // 'üèÉ‚Äç‚ôÇÔ∏è' deƒüi≈ütirildi
                { id: 2, type: 'word', content: 'ÿßŸÑŸÖŸéÿ≥Ÿíÿ¨ŸêÿØ' },
                { id: 2, type: 'emoji', content: 'üïå' },
                { id: 3, type: 'word', content: 'ÿ∑Ÿéÿ®ŸêŸäÿ®' },
                { id: 3, type: 'emoji', content: 'üë®‚Äç‚öïÔ∏è' },
                { id: 4, type: 'word', content: 'ÿ≥ŸéŸäŸëŸéÿßÿ±Ÿéÿ©' }, 
                { id: 4, type: 'emoji', content: 'üöó' },
                { id: 5, type: 'word', content: 'ÿßŸÑŸÖŸéÿØŸíÿ±Ÿéÿ≥Ÿéÿ©' },
                { id: 5, type: 'emoji', content: 'üè´' },
                { id: 6, type: 'word', content: 'ŸÖŸèŸáŸéŸÜŸíÿØŸêÿ≥' },
                { id: 6, type: 'emoji', content: 'üë∑‚Äç‚ôÇÔ∏è' },
                { id: 7, type: 'word', content: 'ŸäŸèÿØŸéÿ±ŸëŸêÿ≥Ÿè' },
                { id: 7, type: 'emoji', content: 'üë®‚Äçüè´' },
                { id: 8, type: 'word', content: 'ÿßŸÑŸÖŸèÿ≥Ÿíÿ™Ÿéÿ¥ŸíŸÅŸéŸâ' },
                { id: 8, type: 'emoji', content: 'üè•' }
            ],
            // Seviye 2 (8 √áift)
            [
                { id: 9, type: 'word', content: 'ŸÇŸéŸÑŸéŸÖ' },
                { id: 9, type: 'emoji', content: '‚úèÔ∏è' },
                { id: 10, type: 'word', content: 'ŸÉŸêÿ™Ÿéÿßÿ®' },
                { id: 10, type: 'emoji', content: 'üìñ' },
                { id: 11, type: 'word', content: 'ÿ®ŸéŸäŸíÿ™' },
                { id: 11, type: 'emoji', content: 'üè†' },
                { id: 12, type: 'word', content: 'ŸÇŸéŸÖŸéÿ±' },
                { id: 12, type: 'emoji', content: 'üåô' },
                { id: 13, type: 'word', content: 'ÿ¥ŸéŸÖŸíÿ≥' },
                { id: 13, type: 'emoji', content: '‚òÄÔ∏è' },
                { id: 14, type: 'word', content: 'ŸÇŸêÿ∑Ÿéÿßÿ±' },
                { id: 14, type: 'emoji', content: 'üöÇ' },
                { id: 15, type: 'word', content: 'ŸáŸéÿßÿ™ŸêŸÅ' },
                { id: 15, type: 'emoji', content: 'üì±' },
                { id: 16, type: 'word', content: 'ŸÖŸêŸÅŸíÿ™Ÿéÿßÿ≠' },
                { id: 16, type: 'emoji', content: 'üîë' }
            ]
        ];

        // --- Gerekli Elementler ---
        const gameBoard = document.getElementById('game-board');
        const instructionText = document.getElementById('instruction-text');
        const feedbackOverlay = document.getElementById('feedback-overlay');
        const feedbackIcon = document.getElementById('feedback-icon');
        
        // --- Ses Deƒüi≈ükenleri ---
        let audioCtx = null;

        // --- Durum Deƒüi≈ükenleri ---
        let hasFlippedCard = false;
        let lockBoard = false; 
        let firstCard, secondCard;
        let matchesFound = 0;
        let totalPairs = 0;
        let currentLevel = 0; 

        // --- SES FONKSƒ∞YONLARI ---
        function initAudioContext() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
        }
        
        function playSound(type) {
            if (!audioCtx) return; 
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            const now = audioCtx.currentTime;

            if (type === 'pop') { 
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(300, now);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.1);
                oscillator.start(now);
                oscillator.stop(now + 0.1);
            } else if (type === 'correct') {
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(440, now);
                oscillator.frequency.linearRampToValueAtTime(880, now + 0.2);
                gainNode.gain.setValueAtTime(0.15, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.2);
                oscillator.start(now);
                oscillator.stop(now + 0.2);
            } else if (type === 'incorrect') {
                oscillator.type = 'triangle'; 
                oscillator.frequency.setValueAtTime(300, now);
                oscillator.frequency.linearRampToValueAtTime(150, now + 0.3);
                gainNode.gain.setValueAtTime(0.15, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.3);
                oscillator.start(now);
                oscillator.stop(now + 0.3);
            }
        }
        
        document.body.addEventListener('click', initAudioContext, { once: true });


        // --- Fisher-Yates Karƒ±≈ütƒ±rma Fonksiyonu ---
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- Oyun Tahtasƒ±nƒ± Olu≈ütur (DEƒûƒ∞≈ûTƒ∞) ---
        function createBoard() {
            gameBoard.innerHTML = ''; 
            
            const currentLevelData = levelsData[currentLevel];
            totalPairs = currentLevelData.length / 2;
            matchesFound = 0;
            // DEƒûƒ∞≈ûTƒ∞: Seviye yazƒ±sƒ± kaldƒ±rƒ±ldƒ±, ana y√∂nerge eklendi
            instructionText.textContent = "ŸÇŸêŸäŸéŸÖŸä | ÿ¨ŸéÿØ ÿßŸÑÿ£ÿ≤ŸíŸàŸéÿßÿ¨ ÿßŸÑŸÖŸèÿ™Ÿéÿ∑Ÿéÿßÿ®ŸêŸÇŸéÿ©";
            
            const shuffledData = shuffle([...currentLevelData]);
            
            shuffledData.forEach(item => {
                const card = document.createElement('div');
                card.classList.add('card');
                card.dataset.id = item.id; 

                card.innerHTML = `
                    <div class="card-inner">
                        <div class="card-face" data-type="${item.type}">
                            ${item.content}
                        </div>
                        <div class="card-back">
                            ÿü
                        </div>
                    </div>
                `;
                
                card.addEventListener('click', flipCard);
                gameBoard.appendChild(card);
            });
        }
        
        // --- Kart √áevirme Mantƒ±ƒüƒ± ---
        function flipCard() {
            if (lockBoard) return; 
            if (this === firstCard) return; 
            
            this.classList.add('is-flipped');
            playSound('pop');

            if (!hasFlippedCard) {
                hasFlippedCard = true;
                firstCard = this;
                return;
            }

            secondCard = this;
            checkForMatch();
        }

        // --- E≈üle≈üme Kontrol√º ---
        function checkForMatch() {
            let isMatch = firstCard.dataset.id === secondCard.dataset.id;

            if (isMatch) {
                disableCards();
            } else {
                unflipCards();
            }
        }

        // --- E≈üle≈üme Varsa ---
        function disableCards() {
            playSound('correct');
            firstCard.removeEventListener('click', flipCard);
            secondCard.removeEventListener('click', flipCard);
            
            firstCard.classList.add('is-matched');
            secondCard.classList.add('is-matched');

            matchesFound++;
            
            if (matchesFound === totalPairs) {
                setTimeout(showWinScreen, 1000);
            }

            resetBoardState();
        }
        
        // --- E≈üle≈üme Yoksa ---
        function unflipCards() {
            lockBoard = true; 
            playSound('incorrect');

            setTimeout(() => {
                firstCard.classList.remove('is-flipped');
                secondCard.classList.remove('is-flipped');
                resetBoardState();
            }, 1500); // 1.5 saniye bekle
        }
        
        // --- Oyun Durumunu Sƒ±fƒ±rla ---
        function resetBoardState() {
            hasFlippedCard = false;
            lockBoard = false;
            firstCard = null;
            secondCard = null;
        }

        // --- Biti≈ü Ekranƒ± (DEƒûƒ∞≈ûTƒ∞) ---
        function showWinScreen() {
            currentLevel++; // Bir sonraki seviyeye ge√ß
            
            if (currentLevel < levelsData.length) {
                // Hen√ºz seviyeler bitmediyse
                // DEƒûƒ∞≈ûTƒ∞: Seviye atlama yazƒ±sƒ± kaldƒ±rƒ±ldƒ±, sadece oyunu sƒ±fƒ±rla
                resetBoardState();
                setTimeout(createBoard, 1500); // 1.5 saniye sonra yeni seviyeyi y√ºkle
            } else {
                // T√ºm seviyeler bittiyse
                instructionText.textContent = "ÿ£Ÿéÿ≠Ÿíÿ≥ŸéŸÜŸíÿ™! ŸÑŸéŸÇŸéÿØ ÿ£ŸéŸÉŸíŸÖŸéŸÑŸíÿ™Ÿé ÿßŸÑÿ¨ŸéŸÖŸêŸäÿπ"; // Hepsini tamamladƒ±n
                feedbackIcon.textContent = '‚úî';
                feedbackIcon.className = 'correct';
                feedbackOverlay.classList.add('show');
            }
        }

        // --- Oyunu Yeniden Ba≈ülat ---
        function restartGame() {
            playSound('pop');
            
            feedbackOverlay.classList.remove('show'); 
            
            if (firstCard) firstCard.classList.remove('is-flipped');
            if (secondCard) secondCard.classList.remove('is-flipped');
            
            currentLevel = 0; // Seviyeyi 0'a sƒ±fƒ±rla
            
            resetBoardState();
            
            setTimeout(createBoard, 500);
        }

        
        // --- Ba≈ülangƒ±√ß ---
        document.addEventListener('DOMContentLoaded', () => {
            createBoard();
        });

    </script>
</body>
</html>